{% extends "base.html" %}
{% block title %}Scan Results - WinScan Pro{% endblock %}
{% block content %}
<div class="page-header">
    <h1>Scan Results</h1>
    <p>Detailed vulnerability findings for Scan ID: <strong>{{ data.scan_id }}</strong></p>
</div>

<div class="panel">
    <div class="panel-header"><h2>Summary</h2></div>
    <div class="summary-cards">
        <div class="summary-card">
            <div class="value">{{ data.summary.hosts_scanned }}</div>
            <div class="label">Hosts Scanned</div>
        </div>
        <div class="summary-card critical">
            <div class="value">{{ data.summary.critical }}</div>
            <div class="label">Critical Issues</div>
        </div>
        <div class="summary-card medium">
            <div class="value">{{ data.summary.medium }}</div>
            <div class="label">Medium Issues</div>
        </div>
        <div class="summary-card low">
            <div class="value">{{ data.summary.low }}</div>
            <div class="label">Low Issues</div>
        </div>
    </div>
    <div class="panel-header" style="margin-top: 2rem;"><h2>Details</h2></div>
    <table class="results-table">
        <thead>
            <tr><th>Host</th><th>Vulnerability</th><th>Status</th><th>Severity</th><th>Plugin</th></tr>
        </thead>
        <tbody>
            {% for result in data.results %}
            <tr>
                <td>{{ result.host }}</td>
                <td>{{ result.vulnerability }}</td>
                <td><span class="status-badge status-{{ result.status.lower() }}">{{ result.status }}</span></td>
                <td><span class="severity-badge severity-{{ result.severity.lower() }}">{{ result.severity }}</span></td>
                <td>{{ result.plugin }}</td>
            </tr>
            {% else %}
            <tr>
                <td colspan="5" style="text-align: center; color: var(--text-muted);">No vulnerabilities were found in this scan.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}