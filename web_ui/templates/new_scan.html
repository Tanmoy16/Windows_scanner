{% extends "base.html" %}
{% block title %}New Scan - WinScan Pro{% endblock %}
{% block content %}
<div class="page-header">
    <h1>New Vulnerability Scan</h1>
    <p>Configure and launch a new Windows vulnerability scan</p>
</div>
<form action="{{ url_for('run_scan_route') }}" method="POST">
    <div class="scan-config-grid">
        <div class="panel">
            <div class="panel-header"><h2>Scan Configuration</h2></div>
            <div class="form-group">
                <label for="targets">Target IP Addresses or Ranges</label>
                <textarea id="targets" name="targets" rows="4" placeholder="Enter IP addresses, CIDR ranges, or IP ranges (one per line)"></textarea>
            </div>
            <div class="form-group">
                <label for="profile">Scan Profile</label>
                <select id="profile" name="profile">
                    <option value="safe">Safe Scan (Top 1000 ports)</option>
                    <option value="deep">Deep Scan (Custom Port Range)</option>
                </select>
            </div>
            <div class="form-group" id="ports-group" style="display: none;">
                <label>Custom Port Range</label>
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <input type="number" id="start_port" name="start_port" placeholder="Start Port" min="1" max="65535">
                    <span>-</span>
                    <input type="number" id="end_port" name="end_port" placeholder="End Port" min="1" max="65535">
                </div>
            </div>
            <div class="form-group">
                <label>Authentication (Optional)</label>
                <input type="text" name="username" placeholder="Username" style="margin-bottom: 0.5rem;">
                <input type="password" name="password" placeholder="Password">
                <small>Required for WinRM-based vulnerability checks</small>
            </div>
        </div>
        <div class="panel">
            <div class="panel-header"><h2>Vulnerability Plugins</h2></div>
            <div class="checkbox-group">
                <label class="checkbox-item"><input type="checkbox" checked> SMB Anonymous Shares</label>
                <label class="checkbox-item"><input type="checkbox" checked> SMBv1 Enabled</label>
                <label class="checkbox-item"><input type="checkbox" checked> WinRM Hotfix Enumeration</label>
                <label class="checkbox-item"><input type="checkbox"> Open RDP Access</label>
                <label class="checkbox-item"><input type="checkbox"> Weak SMB Signing</label>
            </div>
            <div class="panel-header" style="margin-top: 2rem;"><h2>Report Options</h2></div>
             <div class="checkbox-group">
                <label class="checkbox-item"><input type="checkbox"> Generate HTML Report</label>
                <label class="checkbox-item"><input type="checkbox" checked> Generate JSON Report</label>
                <label class="checkbox-item"><input type="checkbox"> Email Results</label>
            </div>
        </div>
    </div>
    <div class="action-buttons">
        <button type="submit" class="btn btn-primary">Start Scan</button>
        <button type="button" class="btn btn-secondary">Save Configuration</button>
    </div>
</form>
{% endblock %}